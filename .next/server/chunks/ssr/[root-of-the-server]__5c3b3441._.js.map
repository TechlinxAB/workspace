{"version":3,"sources":["../../../../lib/roles.ts","../../../../components/Card.tsx","../../../../lib/authz.ts","../../../../components/login-form.tsx/__nextjs-internal-proxy.mjs","../../../../app/login/page.tsx"],"sourcesContent":["export const roles = [\n  \"techlinx_admin\",\n  \"techlinx_webdev\",\n  \"techlinx_marketing\",\n  \"client_admin\",\n  \"client_user\"\n] as const;\n\nexport type Role = (typeof roles)[number];\n\nexport const roleLabels: Record<Role, string> = {\n  techlinx_admin: \"Techlinx Admin\",\n  techlinx_webdev: \"Techlinx Web Dev\",\n  techlinx_marketing: \"Techlinx Marketing\",\n  client_admin: \"Client Admin\",\n  client_user: \"Client User\"\n};\n\nexport function isRole(value: unknown): value is Role {\n  return typeof value === \"string\" && roles.includes(value as Role);\n}\n\nexport function isTechlinxAdmin(role: Role) {\n  return role === \"techlinx_admin\";\n}\n","import type { ReactNode } from \"react\";\n\ntype CardProps = {\n  children: ReactNode;\n  className?: string;\n  frosted?: boolean;\n};\n\nexport function Card({ children, className = \"\", frosted = true }: CardProps) {\n  return (\n    <section\n      className={[\n        \"rounded-[24px] p-5 shadow-[0_14px_40px_rgba(18,18,18,0.08)] transition-all duration-200 hover:-translate-y-[1px] hover:shadow-[0_18px_55px_rgba(18,18,18,0.12)]\",\n        frosted\n          ? \"border border-[rgba(255,255,255,0.95)] bg-[linear-gradient(180deg,rgba(255,255,255,0.66)_0%,rgba(255,255,255,0.52)_100%)] backdrop-blur-2xl ring-1 ring-[rgba(18,18,18,0.03)] shadow-[0_14px_40px_rgba(18,18,18,0.08),inset_0_1px_0_rgba(255,255,255,0.98)]\"\n          : \"border border-[rgba(18,18,18,0.04)]\",\n        className\n      ].join(\" \")}\n    >\n      {children}\n    </section>\n  );\n}\n","import { auth } from \"@/auth\";\nimport prisma from \"@/lib/prisma\";\nimport { isTechlinxAdmin } from \"@/lib/roles\";\n\nexport async function getActiveSessionUser() {\n  const session = await auth();\n  if (!session?.user?.id) {\n    return null;\n  }\n\n  const user = await prisma.user.findUnique({\n    where: { id: session.user.id },\n    select: {\n      id: true,\n      email: true,\n      name: true,\n      role: true,\n      isActive: true,\n      createdAt: true\n    }\n  });\n\n  if (!user || !user.isActive) {\n    await prisma.session.deleteMany({ where: { userId: session.user.id } });\n    return null;\n  }\n\n  return user;\n}\n\nexport async function getAdminSessionUser() {\n  const user = await getActiveSessionUser();\n  if (!user) {\n    return { status: 401 as const };\n  }\n\n  if (!isTechlinxAdmin(user.role)) {\n    return { status: 403 as const, user };\n  }\n\n  return { status: 200 as const, user };\n}\n","// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const LoginForm = registerClientReference(\n    function() { throw new Error(\"Attempted to call LoginForm() from the server but LoginForm is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/login-form.tsx\",\n    \"LoginForm\",\n);\n","import { redirect } from \"next/navigation\";\nimport { Card } from \"@/components/Card\";\nimport { LoginForm } from \"@/components/login-form\";\nimport { getActiveSessionUser } from \"@/lib/authz\";\n\nexport const runtime = \"nodejs\";\n\nfunction getInitialError(error: string | string[] | undefined) {\n  if (error === \"disabled\") {\n    return \"This account is disabled. Contact Techlinx.\";\n  }\n\n  if (typeof error === \"string\" && error.length > 0) {\n    return \"Something went wrong. Try again.\";\n  }\n\n  return null;\n}\n\nexport default async function LoginPage({\n  searchParams\n}: {\n  searchParams: Promise<{ error?: string | string[] }>;\n}) {\n  const user = await getActiveSessionUser();\n  if (user) {\n    redirect(\"/dashboard\");\n  }\n\n  const params = await searchParams;\n  const initialError = getInitialError(params.error);\n\n  return (\n    <main className=\"min-h-screen bg-[radial-gradient(circle_at_top,rgba(205,231,213,0.55),transparent_32%),linear-gradient(180deg,#f8fbf8_0%,#eef5f0_100%)] px-6 py-10\">\n      <div className=\"mx-auto flex min-h-[calc(100vh-5rem)] max-w-md items-center justify-center\">\n        <Card className=\"w-full\">\n          <div className=\"mb-6 text-center\">\n            <p className=\"text-xs font-semibold uppercase tracking-[0.2em] text-[#1d6b3b]\">Techlinx Workspace</p>\n            <h1 className=\"mt-3 text-[24px] font-bold text-ink\">Sign in</h1>\n            <p className=\"mt-1 text-sm text-muted\">Use the credentials issued by Techlinx.</p>\n          </div>\n\n          <LoginForm initialError={initialError} />\n        </Card>\n      </div>\n    </main>\n  );\n}\n"],"names":[],"mappings":"yVAUgD,CAC9C,eAAgB,iBAChB,gBAAiB,mBACjB,mBAAoB,qBACpB,aAAc,eACd,YAAa,aACf,4CCRO,SAAS,EAAK,UAAE,CAAQ,WAAE,EAAY,EAAE,SAAE,GAAU,CAAI,CAAa,EAC1E,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,UAAA,CACC,UAAW,CACT,kKACA,EACI,8PACA,sCACJ,EACD,CAAC,IAAI,CAAC,cAEN,GAGP,6CCtBA,IAAA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAGO,eAAe,IACpB,IAAM,EAAU,MAAM,CAAA,EAAA,EAAA,IAAA,AAAI,IAC1B,GAAI,CAAC,GAAS,MAAM,GAClB,CADsB,MACf,KAGT,IAAM,EAAO,MAAM,EAAA,OAAM,CAAC,IAAI,CAAC,UAAU,CAAC,CACxC,MAAO,CAAE,GAAI,EAAQ,IAAI,CAAC,EAAE,AAAC,EAC7B,OAAQ,CACN,IAAI,EACJ,MAAO,GACP,MAAM,EACN,MAAM,EACN,UAAU,EACV,WAAW,CACb,CACF,UAEA,AAAI,AAAC,GAAS,EAAK,GAAN,KAAc,CAKpB,CALsB,EAC3B,MAAM,EAAA,OAAM,CAAC,OAAO,CAAC,UAAU,CAAC,CAAE,MAAO,CAAE,OAAQ,EAAQ,IAAI,CAAC,EAAE,AAAC,CAAE,GAC9D,KAIX,CA1BA,EAAA,CAAA,CAAA,4FCAO,IAAM,EAAY,CAAA,EAAA,AADzB,EAAA,CAAA,CAAA,OACyB,uBAAA,AAAuB,EAC5C,WAAa,MAAM,AAAI,MAAM,gOAAkO,EAC/P,0DACA,8DAHG,IAAM,EAAY,CAAA,EADzB,AACyB,EADzB,CAAA,CAAA,OACyB,uBAAuB,AAAvB,EACrB,WAAa,MAAM,AAAI,MAAM,gOAAkO,EAC/P,sCACA,gHCLJ,EAAA,CAAA,CAAA,OAAA,IAAA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAgBe,eAAe,EAAU,CACtC,cAAY,CAGb,OACc,AACT,MAAM,CADS,CAAA,EAAA,EAAA,oBAAA,AAAoB,KAErC,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,cAIX,IAAM,EAtBN,AAAI,AAAU,YAAY,CAsBL,CAvBE,EAuBc,CADtB,EAtB4C,IAsBtC,CAAA,EACuB,KAAK,EArBxC,8CAGY,UAAjB,OAAO,GAAsB,EAAM,MAAM,CAAG,EACvC,CAD0C,kCAI5C,KAgBP,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,8JACd,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,sFACb,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,IAAI,CAAA,CAAC,UAAU,mBACd,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,6BACb,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,2EAAkE,uBAC/E,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,+CAAsC,YACpD,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,mCAA0B,+CAGzC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,aAAc,UAKnC,kCA1CuB","ignoreList":[3]}