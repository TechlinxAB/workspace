{"version":3,"sources":["../../../../node_modules/next/src/build/webpack/loaders/next-flight-loader/server-reference.ts","../../../../node_modules/next/src/build/webpack/loaders/next-flight-loader/action-validate.ts","../../../../app/login/actions.ts"],"sourcesContent":["/* eslint-disable import/no-extraneous-dependencies */\nexport { registerServerReference } from 'react-server-dom-webpack/server'\n","// This function ensures that all the exported values are valid server actions,\n// during the runtime. By definition all actions are required to be async\n// functions, but here we can only check that they are functions.\nexport function ensureServerEntryExports(actions: any[]) {\n  for (let i = 0; i < actions.length; i++) {\n    const action = actions[i]\n    if (typeof action !== 'function') {\n      throw new Error(\n        `A \"use server\" file can only export async functions, found ${typeof action}.\\nRead more: https://nextjs.org/docs/messages/invalid-use-server-value`\n      )\n    }\n  }\n}\n","\"use server\";\n\nimport { AuthError } from \"next-auth\";\nimport { redirect } from \"next/navigation\";\nimport { signIn } from \"@/auth\";\n\nexport type LoginActionState = {\n  error: string | null;\n  email: string;\n};\n\nfunction getErrorMessage(code: string | null) {\n  if (code === \"disabled\") {\n    return \"This account is disabled. Contact Techlinx.\";\n  }\n\n  if (code === \"rate_limited\") {\n    return \"Too many login attempts. Try again in a few minutes.\";\n  }\n\n  return \"Incorrect email or password.\";\n}\n\nexport async function loginAction(_: LoginActionState, formData: FormData): Promise<LoginActionState> {\n  const email = String(formData.get(\"email\") ?? \"\")\n    .trim()\n    .toLowerCase();\r\n  const password = String(formData.get(\"password\") ?? \"\");\n\n  if (!email || !password) {\n    return { error: \"Email and password are required.\", email };\n  }\n\n  try {\n    await signIn(\"credentials\", {\n      redirect: false,\n      email,\n      password\n    });\n  } catch (error) {\n    if (error instanceof AuthError) {\n      if (error.type === \"CredentialsSignin\") {\n        const code = \"code\" in error && typeof error.code === \"string\" ? error.code : null;\n        return { error: getErrorMessage(code), email };\n      }\n\n      if (\"kind\" in error && error.kind === \"signIn\") {\n        return { error: \"Incorrect email or password.\", email };\n      }\n\n      return { error: \"Something went wrong. Try again.\", email };\n    }\n\n    return { error: \"Something went wrong. Try again.\", email };\n  }\n\n  redirect(\"/dashboard\");\n}\n"],"names":["registerServerReference","ensureServerEntryExports","actions","i","length","action","Error"],"mappings":"6NAAoD,OAAA,cAAA,CAAA,EAAA,aAAA,oCAC3CA,0BAAAA,qCAAAA,EAAAA,uBAAuB,YAAQ,CAAA,CAAA,IAAA,iCCEjC,SAASC,EAAyBC,CAAc,EACrD,IAAK,IAAIC,EAAI,EAAGA,EAAID,EAAQE,MAAM,CAAED,IAAK,CACvC,IAAME,EAASH,CAAO,CAACC,EAAE,CACzB,GAAsB,YAAlB,AAA8B,OAAvBE,EACT,MAAM,OAAA,cAEL,CAFK,AAAIC,MACR,CAAC,2DAA2D,EAAE,OAAOD,EAAO;AAAA,oEAAuE,CAAC,EADhJ,oBAAA,OAAA,mBAAA,gBAAA,CAEN,EAEJ,CACF,0EATgBJ,2BAAAA,qCAAAA,6CCDhB,EAAA,CAAA,CAAA,OAAA,IAAA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,CAAA,CAAA,OAAA,IAAA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAmBO,eAAe,EAAY,CAAmB,CAAE,CAAkB,EACvE,IAAM,EAAQ,OAAO,EAAS,GAAG,CAAC,UAAY,IAC3C,IAAI,GACJ,WAAW,GACR,EAAW,OAAO,EAAS,GAAG,CAAC,aAAe,IAEpD,GAAI,CAAC,GAAS,CAAC,EACb,MAAO,CAAE,CADc,KACP,yCAAoC,CAAM,EAG5D,GAAI,CACF,MAAM,CAAA,EAAA,EAAA,MAAA,AAAM,EAAC,cAAe,CAC1B,UAAU,QACV,WACA,CACF,EACF,CAAE,MAAO,EAAO,CACd,GAAI,aAAiB,EAAA,SAAS,CAAE,CAC9B,GAAmB,sBAAf,EAAM,IAAI,CAA0B,OAEtC,MAAO,CAAE,MA/BX,AAAS,AAAb,CA+BsB,WA/BG,EADF,EA+BJ,CACmB,CAhCI,OA+Bb,GAA+B,UAAtB,OAAO,EAAM,IAAI,CAAgB,EAAM,IAAI,CAAG,MA7B3E,8CAGI,gBAAgB,CAAzB,EACK,uDAGF,qCAuBsC,CAAM,CAC/C,CAEA,GAAI,SAAU,GAAwB,UAAU,CAAzB,EAAM,IAAI,CAC/B,MAAO,CAAE,MAAO,qCAAgC,CAAM,CAI1D,CAEA,MAAO,CAAE,MAAO,yCAAoC,CAAM,CAC5D,CAEA,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,aACX,0CAlCsB,IAAA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA","ignoreList":[0,1]}