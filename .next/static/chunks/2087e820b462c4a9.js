(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,80334,e=>{"use strict";var s=e.i(43476);function t({children:e,className:t="",frosted:a=!0}){return(0,s.jsx)("section",{className:["rounded-[24px] p-5 shadow-[0_14px_40px_rgba(18,18,18,0.08)] transition-all duration-200 hover:-translate-y-[1px] hover:shadow-[0_18px_55px_rgba(18,18,18,0.12)]",a?"border border-[rgba(255,255,255,0.95)] bg-[linear-gradient(180deg,rgba(255,255,255,0.66)_0%,rgba(255,255,255,0.52)_100%)] backdrop-blur-2xl ring-1 ring-[rgba(18,18,18,0.03)] shadow-[0_14px_40px_rgba(18,18,18,0.08),inset_0_1px_0_rgba(255,255,255,0.98)]":"border border-[rgba(18,18,18,0.04)]",t].join(" "),children:e})}e.s(["Card",()=>t])},5949,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(53010),r=e.i(80334);let l={email:"",name:"",role:"client_user",temporaryPassword:""};function i(){let[e,i]=(0,t.useState)([]),[n,o]=(0,t.useState)(null),[d,c]=(0,t.useState)(!0),[x,m]=(0,t.useState)(!1),[b,p]=(0,t.useState)(l),[u,h]=(0,t.useState)({}),[g,f]=(0,t.useTransition)();async function j(){c(!0),o(null);try{let e=await fetch("/api/admin/users",{cache:"no-store"});if(!e.ok)throw Error("Failed to load users.");let s=await e.json();i(s.users)}catch(e){o(e instanceof Error?e.message:"Failed to load users.")}finally{c(!1)}}async function y(){let e=await fetch("/api/admin/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)});if(!e.ok)throw Error((await e.json()).error??"Failed to create user.");await j(),p(l),m(!1)}async function N(e,s){let t=await fetch(`/api/admin/users/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!t.ok)throw Error((await t.json()).error??"Failed to update user.");await j()}return(0,t.useEffect)(()=>{j()},[]),(0,s.jsxs)("div",{className:"space-y-5",children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-[22px] font-bold text-ink",children:"Users"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-muted",children:"Create users, change roles, and activate or disable workspace access."})]}),(0,s.jsx)("button",{type:"button",onClick:()=>m(!0),className:"focus-ring rounded-full bg-[#1d6b3b] px-4 py-2.5 text-sm font-semibold text-white transition hover:bg-[#185b32]",children:"Create user"})]}),n?(0,s.jsx)("p",{className:"rounded-[24px] border border-[rgba(205,84,71,0.18)] bg-dangerBg px-4 py-3 text-sm text-danger",children:n}):null,(0,s.jsx)(r.Card,{className:"overflow-hidden",children:d?(0,s.jsx)("p",{className:"text-sm text-muted",children:"Loading users..."}):(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full text-left",children:[(0,s.jsx)("thead",{children:(0,s.jsx)("tr",{className:"border-b border-[rgba(18,18,18,0.08)]",children:["Name","Email","Role","Status","Created","Actions"].map(e=>(0,s.jsx)("th",{className:"px-2 py-2 text-[12px] font-semibold text-muted",children:e},e))})}),(0,s.jsx)("tbody",{children:e.map(e=>(0,s.jsxs)("tr",{className:"border-b border-[rgba(18,18,18,0.06)] align-top",children:[(0,s.jsx)("td",{className:"px-2 py-3 text-sm font-semibold text-ink",children:e.name??"Unnamed user"}),(0,s.jsx)("td",{className:"px-2 py-3 text-sm text-muted",children:e.email}),(0,s.jsx)("td",{className:"px-2 py-3 text-sm text-ink",children:a.roleLabels[e.role]}),(0,s.jsx)("td",{className:"px-2 py-3 text-sm",children:(0,s.jsx)("span",{className:["rounded-full border px-2.5 py-1 text-xs font-semibold",e.isActive?"border-[rgba(52,168,83,0.18)] bg-successBg text-success":"border-[rgba(205,84,71,0.18)] bg-dangerBg text-danger"].join(" "),children:e.isActive?"Active":"Disabled"})}),(0,s.jsx)("td",{className:"px-2 py-3 text-sm text-muted",children:new Date(e.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}),(0,s.jsx)("td",{className:"px-2 py-3 text-sm",children:(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,s.jsx)("button",{type:"button",disabled:g,onClick:()=>f(()=>{N(e.id,{isActive:!e.isActive}).catch(e=>{o(e instanceof Error?e.message:"Failed to update user.")})}),className:"focus-ring rounded-full border border-[rgba(18,18,18,0.08)] px-3 py-2 text-xs font-semibold text-ink transition hover:bg-[rgba(241,244,242,0.8)] disabled:opacity-60",children:e.isActive?"Disable":"Enable"}),(0,s.jsx)("select",{value:e.role,onChange:s=>f(()=>{N(e.id,{role:s.target.value}).catch(e=>{o(e instanceof Error?e.message:"Failed to update user.")})}),className:"focus-ring rounded-full border border-[rgba(18,18,18,0.08)] bg-white px-3 py-2 text-xs font-semibold text-ink",children:a.roles.map(e=>(0,s.jsx)("option",{value:e,children:a.roleLabels[e]},e))})]}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,s.jsx)("input",{type:"password",value:u[e.id]??"",onChange:s=>h(t=>({...t,[e.id]:s.target.value})),className:"focus-ring h-10 min-w-[220px] rounded-full border border-[rgba(18,18,18,0.08)] bg-white px-4 text-xs text-ink",placeholder:"Set temporary password"}),(0,s.jsx)("button",{type:"button",disabled:g||!u[e.id],onClick:()=>f(()=>{N(e.id,{temporaryPassword:u[e.id]}).then(()=>{h(s=>({...s,[e.id]:""}))}).catch(e=>{o(e instanceof Error?e.message:"Failed to reset password.")})}),className:"focus-ring rounded-full border border-[rgba(18,18,18,0.08)] px-3 py-2 text-xs font-semibold text-ink transition hover:bg-[rgba(241,244,242,0.8)] disabled:opacity-60",children:"Reset password"})]})]})})]},e.id))})]})})}),x?(0,s.jsx)("div",{className:"fixed inset-0 z-50 bg-[rgba(18,18,18,0.26)] px-4 py-8 backdrop-blur-sm",children:(0,s.jsx)("div",{className:"mx-auto max-w-xl",children:(0,s.jsxs)(r.Card,{className:"relative",children:[(0,s.jsxs)("div",{className:"mb-5 flex items-start justify-between gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-[20px] font-bold text-ink",children:"Create workspace user"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-muted",children:"Add a workspace user and assign the correct Techlinx or client role."})]}),(0,s.jsx)("button",{type:"button",onClick:()=>m(!1),className:"focus-ring rounded-full border border-[rgba(18,18,18,0.08)] px-3 py-1.5 text-sm font-semibold text-muted",children:"Close"})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,s.jsxs)("label",{className:"space-y-1 text-sm",children:[(0,s.jsx)("span",{className:"font-semibold text-ink",children:"Name"}),(0,s.jsx)("input",{type:"text",value:b.name,onChange:e=>p(s=>({...s,name:e.target.value})),className:"focus-ring h-11 w-full rounded-2xl border border-[rgba(18,18,18,0.08)] bg-white px-4 text-sm text-ink",placeholder:"User name"})]}),(0,s.jsxs)("label",{className:"space-y-1 text-sm",children:[(0,s.jsx)("span",{className:"font-semibold text-ink",children:"Email"}),(0,s.jsx)("input",{type:"email",value:b.email,onChange:e=>p(s=>({...s,email:e.target.value})),className:"focus-ring h-11 w-full rounded-2xl border border-[rgba(18,18,18,0.08)] bg-white px-4 text-sm text-ink",placeholder:"user@company.com"})]}),(0,s.jsxs)("label",{className:"space-y-1 text-sm",children:[(0,s.jsx)("span",{className:"font-semibold text-ink",children:"Role"}),(0,s.jsx)("select",{value:b.role,onChange:e=>p(s=>({...s,role:e.target.value})),className:"focus-ring h-11 w-full rounded-2xl border border-[rgba(18,18,18,0.08)] bg-white px-4 text-sm text-ink",children:a.roles.map(e=>(0,s.jsx)("option",{value:e,children:a.roleLabels[e]},e))})]}),(0,s.jsxs)("label",{className:"space-y-1 text-sm",children:[(0,s.jsx)("span",{className:"font-semibold text-ink",children:"Temporary password"}),(0,s.jsx)("input",{type:"password",value:b.temporaryPassword,onChange:e=>p(s=>({...s,temporaryPassword:e.target.value})),className:"focus-ring h-11 w-full rounded-2xl border border-[rgba(18,18,18,0.08)] bg-white px-4 text-sm text-ink",placeholder:"Temp password"})]})]}),(0,s.jsxs)("div",{className:"mt-6 flex justify-end gap-2",children:[(0,s.jsx)("button",{type:"button",onClick:()=>m(!1),className:"focus-ring rounded-full border border-[rgba(18,18,18,0.08)] px-4 py-2.5 text-sm font-semibold text-muted",children:"Cancel"}),(0,s.jsx)("button",{type:"button",disabled:g,onClick:()=>f(()=>{y().catch(e=>{o(e instanceof Error?e.message:"Failed to create user.")})}),className:"focus-ring rounded-full bg-[#1d6b3b] px-4 py-2.5 text-sm font-semibold text-white transition hover:bg-[#185b32] disabled:opacity-60",children:"Create user"})]})]})})}):null]})}e.s(["AdminUsersManager",()=>i])}]);